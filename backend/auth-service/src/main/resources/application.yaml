spring:
  datasource:
    url: ${AUTH_DB_URL:jdbc:postgresql://auth-db:5432/authdb}
    username: ${AUTH_DB_USERNAME:authuser}
    password: ${AUTH_DB_PASSWORD:authpass}
    driver-class-name: org.postgresql.Driver

  jpa:
    hibernate:
      ddl-auto: validate       # ✅ schema managed by Flyway
    properties:
      hibernate:
        format_sql: false
        show_sql: false

  kafka:
    bootstrap-servers: ${KAFKA_BOOTSTRAP_SERVERS:kafka:9092}
    properties:
      schema.registry.url: ${SCHEMA_REGISTRY_URL:http://schema-registry:8081}

    producer:
      key-serializer: org.apache.kafka.common.serialization.StringSerializer
      value-serializer: io.confluent.kafka.serializers.KafkaAvroSerializer

  flyway:
    enabled: true
    locations: classpath:db/migration

  # ✅ Redis (Docker network: redis:6379)
  data:
    redis:
      host: ${REDIS_HOST:redis}
      port: ${REDIS_PORT:6379}
      password: ${REDIS_PASSWORD:}     # 비번 없으면 빈 값
      database: ${REDIS_DATABASE:0}
      timeout: 2s

  # (선택) Spring Cache를 Redis로 쓰고 싶을 때만 켜기
  # cache:
  #   type: redis
  #   redis:
  #     time-to-live: 10m
  #     cache-null-values: false

  mail:
    host: ${BREVO_HOST:smtp-relay.brevo.com}
    port: ${BREVO_PORT:587}
    username: ${BREVO_USERNAME}
    password: ${BREVO_PASSWORD}
    properties:
      mail.smtp.auth: true
      mail.smtp.starttls.enable: true

timeeconomy:
  outbox:
    topics:
      EmailChangeCommitted.v1: auth.email.change.committed.v1
      VerificationOtpDeliveryRequested.v1: auth.verification.otp.delivery.requested.v1
      AuthUserRegistered.v2: auth.user.registered.v2

app:
  mail:
    from: ${APP_MAIL_FROM}
  verification:
    hmac-secret: ${VERIFICATION_HMAC_SECRET}
  internal:
    token: ${APP_INTERNAL_TOKEN}

brevo:
  sms:
    api-key: ${BREVO_SMS_API_KEY}
    sender-name: ${BREVO_SMS_SENDER_NAME:TimeEconomy}

jwt:
  secret: ${JWT_SECRET}
  issuer: "timeeconomy-auth"
  access-token-exp-seconds: 900     # 15 min
  refresh-token-exp-days: 7

userservice:
  base-url: http://user-service:8080

# logging:
#   level:
#     org.springframework.security: DEBUG